@if(offlineService.isOnline()) {
<div class="text-[#2A5C66] flex flex-col gap-3 w-full h-full tablet:p-5 p-4">
    <div
    class=" w-full rounded-[10px] flex flex-row justify-center tablet:justify-start items-center tablet:px-3 px-1">
        <div class="flex flex-col w-full justify-end">
            <div class="flex flex-row w-full" >
                <p class="curosr-default text-mainGreen font-DMSans font-bold text-[1.5rem]  tablet:text-[2.5rem] py-2">
                    Welcome to Dashboard!
                </p>
            </div>
        

        </div>
        <!-- <div class="flex flex-col w-full">
            <div class="flex flex-row w-full items-center justify-end " >

                <button class="rounded-lg px-2 flex flex-row items-center gap-1 bg-[#5bcad8] text-white tablet:text-[1rem] text-[0.8rem] hover:shadow-md pt-2 pb-2" >
                    <mat-icon>
                        <svg width="24" height="24" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.24609 11.8906V21.5469C4.24609 22.0804 4.45804 22.5921 4.83531 22.9694C5.21258 23.3466 5.72427 23.5586 6.25781 23.5586H20.7422C21.2757 23.5586 21.7874 23.3466 22.1647 22.9694C22.542 22.5921 22.7539 22.0804 22.7539 21.5469V11.8906C22.7539 11.3571 22.542 10.8454 22.1647 10.4681C21.7874 10.0909 21.2757 9.87891 20.7422 9.87891H18.7305C18.4103 9.87891 18.1033 10.0061 17.877 10.2324C17.6506 10.4588 17.5234 10.7658 17.5234 11.0859C17.5234 11.4061 17.6506 11.7131 17.877 11.9394C18.1033 12.1658 18.4103 12.293 18.7305 12.293H20.3398V21.1445H6.66016V12.293H8.26953C8.58966 12.293 8.89667 12.1658 9.12303 11.9394C9.34939 11.7131 9.47656 11.4061 9.47656 11.0859C9.47656 10.7658 9.34939 10.4588 9.12303 10.2324C8.89667 10.0061 8.58966 9.87891 8.26953 9.87891H6.25781C5.72427 9.87891 5.21258 10.0909 4.83531 10.4681C4.45804 10.8454 4.24609 11.3571 4.24609 11.8906ZM16.6695 7.91647L14.707 5.95605V14.3047C14.707 14.6248 14.5799 14.9318 14.3535 15.1582C14.1271 15.3845 13.8201 15.5117 13.5 15.5117C13.1799 15.5117 12.8729 15.3845 12.6465 15.1582C12.4201 14.9318 12.293 14.6248 12.293 14.3047V5.95605L10.3305 7.91949C10.2183 8.03177 10.085 8.12083 9.93827 8.1816C9.79157 8.24236 9.63434 8.27364 9.47556 8.27364C9.31677 8.27364 9.15954 8.24236 9.01284 8.1816C8.86615 8.12083 8.73285 8.03177 8.62058 7.91949C8.5083 7.80721 8.41924 7.67392 8.35847 7.52722C8.29771 7.38053 8.26643 7.2233 8.26643 7.06451C8.26643 6.90573 8.29771 6.7485 8.35847 6.6018C8.41924 6.4551 8.5083 6.32181 8.62058 6.20953L12.644 2.18609C12.7562 2.07357 12.8894 1.98428 13.0361 1.92336C13.1828 1.86244 13.3401 1.83108 13.499 1.83108C13.6579 1.83108 13.8152 1.86244 13.9619 1.92336C14.1086 1.98428 14.2418 2.07357 14.354 2.18609L18.3774 6.20953C18.4897 6.32181 18.5788 6.4551 18.6395 6.6018C18.7003 6.7485 18.7316 6.90573 18.7316 7.06451C18.7316 7.38519 18.6042 7.69274 18.3774 7.91949C18.1507 8.14625 17.8431 8.27364 17.5224 8.27364C17.2018 8.27364 16.8942 8.14625 16.6675 7.91949L16.6695 7.91647Z" fill="#ffffff"/>
                        </svg>
                    </mat-icon>
                    {{this.yearNow()}} Sales Report
                </button>
            </div>

        </div> -->
    </div>

    <div
    class=" w-full rounded-[10px] flex flex-row justify-center mobileL:justify-start items-center mobileL:px-5 px-1">
        <!-- <div class="flex flex-col mobileL:w-[15%] w-[40%]">
            <p class="curosr-default text-formBorder font-DMSans font-medium text-[1rem]  mobileL:text-[2rem] py-2">
            Sales Analytics 
            </p>
        </div>
        <div class="flex flex-col tablet:w-[85%] w-[60%]">
            <hr>
        </div> -->
    </div>
    <div class="flex flex-row w-full shadow-md border bg-white px-4 py-3 rounded-lg justify-between">
        <div>
            <h1 class="font-DMSans text-formBorder font-medium text-[1.5rem]">Hey, {{this.getUserName()}}</h1>
            <h1 class="font-DMSans text-formText font-medium text-[2rem] ">{{this.monthNow()}} Sales Report</h1>
        </div>
        <div class="flex flex-row justify-end items-center" >
            <button class="rounded-[5px] p-2 bg-[#5bcad8] text-white text-[1rem] hover:shadow-md pt-2 pb-2 max-h-max flex gap-2" 
            (click)="exportYearlySales()"
            > Export 			
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="size-6">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 9.75v6.75m0 0-3-3m3 3 3-3m-8.25 6a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z" />
            </svg>
            </button> 
        </div>
    </div>

    <div class="flex gap-4 flex-wrap text-white">
        <div class="flex-1 border-2 border-gray-[##E5E7EB] rounded-lg px-4 py-3 hover:shadow-md shadow-md bg-mainGreen flex flex-col gap-3">
            <div class="flex gap-3 items-center">
                <div class="bg-[#5BCAD8]  p-1 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class=" size-4">
                    <path d="M64 64C28.7 64 0 92.7 0 128L0 384c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L64 64zm64 320l-64 0 0-64c35.3 0 64 28.7 64 64zM64 192l0-64 64 0c0 35.3-28.7 64-64 64zM448 384c0-35.3 28.7-64 64-64l0 64-64 0zm64-192c-35.3 0-64-28.7-64-64l64 0 0 64zM288 160a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"/></svg>
                </div>
                <p class="flex-1">Gross Revenue</p>
            </div>
            @if(salesAnalyticsLoading) {
                Loading...
            } @else {
                <div>
                    <p class="text-[2rem] font-medium">₱{{salesAnalytics?.gross_revenue ? (salesAnalytics?.gross_revenue | number: '1.2-2') : '-'}}</p>
                    <div class="flex justify-start gap-2">
                        @if(salesAnalytics?.gross_revenue_diff) {
                        <span>
                            <svg class="size-6 text-mainBlueB m-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941" />
                            </svg>
                        </span>

                            <p>{{salesAnalytics?.gross_revenue_diff ? (salesAnalytics?.gross_revenue_diff | number: '1.2-2') : '-'}}% <span class="text-[0.75rem] text-gray-100">+₱{{salesAnalytics!.gross_revenue - salesAnalytics!.prev_gross_revenue| number: '1.2-2'}} this month</span></p>
                        } @else {
                            <p>-</p>
                        }
                    </div>                        
                </div>
            }
        </div>
            <div class="flex-1 border-2 border-gray-[#E5E7EB] rounded-lg px-4 py-3 hover:shadow-md shadow-md bg-mainGreen flex flex-col gap-3">
                <div class="flex gap-3 items-center">
                    <div class="bg-[#5BCAD8] p-1 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class=" size-4">
                        <path d="M64 64C28.7 64 0 92.7 0 128L0 384c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L64 64zm64 320l-64 0 0-64c35.3 0 64 28.7 64 64zM64 192l0-64 64 0c0 35.3-28.7 64-64 64zM448 384c0-35.3 28.7-64 64-64l0 64-64 0zm64-192c-35.3 0-64-28.7-64-64l64 0 0 64zM288 160a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"/></svg>
                    </div>
                    <p class="flex-1">Expenses</p>
                </div>
                @if(salesAnalyticsLoading) {
                    Loading...
                    <!-- <mat-spinner [diameter]="30"></mat-spinner> -->
                } @else {
                    <div>
                        <p class="text-[2rem] font-medium">₱{{salesAnalytics?.curr_expenses ? (salesAnalytics?.curr_expenses | number: '1.2-2') : '-'}}</p>
                        <div class="flex justify-start gap-2">
                            @if(salesAnalytics?.expenses_diff) {
                                <span>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-mainBlueB m-0">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941" />
                                    </svg>
                                </span>
                                <p>{{salesAnalytics?.expenses_diff ? (salesAnalytics?.expenses_diff | number: '1.2-2') : '-' }}% <span class="text-[0.75rem] text-gray-100">+₱{{salesAnalytics!.curr_expenses - salesAnalytics!.prev_expenses| number: '1.2-2'}} this month</span></p>
                            } @else {
                                <p>-</p>
                            }
                        </div>                        
                    </div>
                }
    
            </div>
            <!-- <div class="flex-1 border-2 border-gray-[##E5E7EB] rounded-lg px-4 py-3 bg-mainGreen flex flex-col gap-3">
                <div class="flex gap-3 items-center">
                    <div class="bg-[#5BCAD8] p-1 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class=" size-4">
                        <path d="M64 64C28.7 64 0 92.7 0 128L0 384c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L64 64zm64 320l-64 0 0-64c35.3 0 64 28.7 64 64zM64 192l0-64 64 0c0 35.3-28.7 64-64 64zM448 384c0-35.3 28.7-64 64-64l0 64-64 0zm64-192c-35.3 0-64-28.7-64-64l64 0 0 64zM288 160a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"/></svg>
                    </div>
                    <p class="flex-1">Average Gross Revenue</p>
                </div>
                @if(salesAnalyticsLoading) {
                    Loading...
                } @else {
                    <div>
                        <p class="text-[2rem] font-medium">₱{{salesAnalytics?.average_gross_revenue ? (salesAnalytics?.average_gross_revenue | number: '1.2-2') : '-'}}</p>
                        <div class="flex justify-start gap-2">
                            @if(salesAnalytics?.gross_revenue_diff) {
                                <span>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-mainBlueB m-0">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941" />
                                    </svg>
                                </span>
                                <p>{{salesAnalytics?.average_gross_revenue_diff ? (salesAnalytics?.average_gross_revenue_diff | number: '1.2-2') : '-' }}% <span class="text-[0.75rem] text-gray-100">+₱{{salesAnalytics!.average_gross_revenue - salesAnalytics!.average_gross_revenue_diff| number: '1.2-2'}} this month</span></p>
                            } @else {
                                <p>-</p>
                            }
                        </div>                        
                    </div>
                }
    
            </div>
             -->
            <div class="flex-1 border-2 border-gray-[##E5E7EB] rounded-lg px-4 py-3 bg-mainGreen flex flex-col gap-3">
                <div class="flex gap-3 items-center">
                    <div class="bg-[#5BCAD8] p-1 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class=" size-4">
                        <path d="M64 64C28.7 64 0 92.7 0 128L0 384c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L64 64zm64 320l-64 0 0-64c35.3 0 64 28.7 64 64zM64 192l0-64 64 0c0 35.3-28.7 64-64 64zM448 384c0-35.3 28.7-64 64-64l0 64-64 0zm64-192c-35.3 0-64-28.7-64-64l64 0 0 64zM288 160a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"/></svg>
                    </div>
                    <p class="flex-1">Net Revenue</p>
                </div>
                @if(salesAnalyticsLoading) {
                    Loading...

                } @else {
                    <div>
                        <p class="text-[2rem] font-medium">₱{{salesAnalytics?.net_revenue ? (salesAnalytics?.net_revenue | number: '1.2-2') : '-'}}</p>
                        <div class="flex justify-start gap-2">
                            @if(salesAnalytics?.net_revenue_diff) {
                                <span>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-mainBlueB m-0">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941" />
                                    </svg>
                                </span>
                                <p>{{salesAnalytics?.net_revenue_diff ? (salesAnalytics?.net_revenue_diff | number: '1.2-2') : '-'}}% <span class="text-[0.75rem] text-gray-100">+₱{{salesAnalytics!.net_revenue - salesAnalytics!.prev_net_revenue| number: '1.2-2'}} this month</span></p>
                            } @else {
                                <p>-</p>
                            }
                        </div>                        
                    </div>
                }
    
            </div>
            <div class="flex-1 border-2 border-gray-[#E5E7EB] rounded-lg px-4 py-3 hover:shadow-md shadow-md bg-mainGreen flex flex-col gap-3">
                <div class="flex gap-3 items-center">
                    <div class="bg-[#5BCAD8] p-1 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class=" size-4">
                        <path d="M64 64C28.7 64 0 92.7 0 128L0 384c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L64 64zm64 320l-64 0 0-64c35.3 0 64 28.7 64 64zM64 192l0-64 64 0c0 35.3-28.7 64-64 64zM448 384c0-35.3 28.7-64 64-64l0 64-64 0zm64-192c-35.3 0-64-28.7-64-64l64 0 0 64zM288 160a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"/></svg>
                    </div>
                    <p class="flex-1">Average Net Revenue</p>
                </div>
                @if(salesAnalyticsLoading) {
                    Loading...
                } @else {
                    <div>
                        <p class="text-[2rem] font-medium">₱{{ salesAnalytics?.average_net_revenue? (salesAnalytics?.average_net_revenue | number: '1.2-2') : '-'}}</p>
                        <div class="flex justify-start gap-2">
                            @if(salesAnalytics?.average_net_revenue_diff) {
                                <span>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-mainBlueB m-0">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941" />
                                    </svg>
                                </span>
                                <p>{{salesAnalytics?.average_net_revenue_diff ? (salesAnalytics?.average_net_revenue_diff | number: '1.2-2') : '-'}}% <span class="text-[0.75rem] text-gray-100">+₱{{salesAnalytics!.average_net_revenue - salesAnalytics!.prev_average_net_revenue| number: '1.2-2'}} this month</span></p>
                            } @else {
                                <p>-</p>
                            }
                        </div>                        
                    </div>
                }
    
        </div>
    </div>

    <!-- First Row -->
    <div class="flex flex-col tablet:flex-row justify-center gap-3">
        <!-- <div class="flex flex-col gap-3 w-full tablet:w-[20%]"> -->
            <!-- <div class="">
                <h1 class="font-DMSans text-formBorder font-medium text-[1.5rem] pl-3 ">Earnings</h1>
            </div> -->
            <!-- <div class="mobileL:hover:shadow-md bg-white shadow-md border p-3  rounded-lg flex flex-row pl-3">
                <div class="flex flex-col w-full ">
                    <h1 class="font-DMSans text-formBorder font-medium text-[1.5rem]">Hey, {{this.getUserName()}}</h1>
                    <h1 class="font-DMSans text-formText font-medium text-[2rem] ">{{this.monthNow()}} Sales Report</h1>
                    <div class="flex flex-row justify-end " >
                        <button class="rounded-lg p-2 bg-[#5bcad8] text-white text-[1rem] hover:shadow-md pt-2 pb-2" > Download </button>
                    </div>
                </div>
            </div> -->
            <!-- <div class="flex flex-col mobileL:flex-row gap-3 h-full w-full" >
                <div class="mobileL:hover:shadow-md bg-[#eb8f71]  shadow-md border p-3  rounded-lg  flex flex-row w-full pl-3">
                    <div class="flex flex-col w-full" >

                        <div class="flex flex-row">
                            <h1 class="font-DMSans text-white font-medium text-[1.5rem]">{{this.monthNow()}} Sales</h1>

                        </div>
                        <div class="flex flex-row">
                            <h1 class="font-DMSans font-bold text-white text-[1rem] "> ₱ {{this.totalSales}}  </h1>
                        </div>
                    </div>
                </div>

                <div class="tablet:hover:shadow-md bg-white shadow-md border p-3  rounded-lg  flex flex-row w-full">
                    <div class="flex flex-row w-full" >
                        <div class="flex flex-col justify-center items-center">
                            <div class="flex flex-row">`
                            </div>
                        </div>

                        
                        <div class="w-full">
                            <canvas id="pieChart" width="400" height="200" ></canvas>
                        </div>
                        <div class="flex flex-col w-full ">
                            <h1 class="font-DMSans  font-medium text-[1.3rem]">{{this.monthNow()}} Sales Breakdown</h1>
                            <h1 class="font-DMSans text-formBorder font-medium text-[1.0rem]">Top 3 Categories</h1>

                        </div>
`
                    </div>
                    
                    
                </div>
            </div> -->
    
        <!-- </div> -->
        <div class="bg-white tablet:hover:shadow-md flex flex-1 flex-col  rounded-lg shadow-md border p-2">
        <!-- <div class="bg-white tablet:hover:shadow-md flex flex-col tablet:w-[80%] rounded-lg shadow-md border p-2"> -->
            <div class="p-3 flex flex-row">
                <div class="flex flex-col w-full ">
                    <!-- <h1 class="font-DMSans text-formBorder font-medium text-[1.5rem]">Sales Overview</h1> -->
                     <div class="flex justify-between">
                        <h1 class="font-DMSans text-formText font-medium text-[1.5rem] ">
                            @if(saleVsExpenses.sales.length > 5) {
                                {{yearNow()}}
                            } @else {
                                {{this.monthNow()}} 
                            }
                            
                            Revenue vs Sales</h1>
                        <button mat-button [matMenuTriggerFor]="revenuevscostmenu">Plot by</button>
                        <mat-menu #revenuevscostmenu="matMenu">
                        <button mat-menu-item (click)="analyticsService.querySaleVsRevenue('this_month')">This month</button>
                        <button mat-menu-item (click)="analyticsService.querySaleVsRevenue('this_year')">This year</button>
                        </mat-menu>
                     </div>
                    <div class="w-full">
                        <canvas id="revenueChart" height="240" ></canvas>
                    </div>
                </div>
                
            </div>
        </div>


        
    </div>

    <div
    class=" w-full rounded-[10px] flex flex-row justify-center tablet:justify-start items-center tablet:px-5 px-1 pt-2">
        <!-- <div class="flex flex-col tablet:w-[18%] w-[50%]"> -->
        <div class="flex flex-col tablet:w-full w-[50%]">
            <p class="curosr-default text-formBorder font-DMSans font-medium text-[1rem]  tablet:text-[2rem] py-2">
            Inventory Analytics 
            </p>
        </div>
        <div class="flex flex-col tablet:w-[82%] w-[50%]">
            <hr>
        </div>
    </div>



    <!-- Second Row -->
    <div class="flex flex-col w-full tablet:flex-row justify-center gap-3 items-center">
        <div
        
        class="flex flex-col tablet:w-[60%] w-full h-full gap-2 ">
            
        
            <div class="tablet:hidden flex flex-row h-[150px] w-full border hover:shadow-md  shadow-md rounded-lg ">
                <div class="flex flex-row w-full" >

                    <div class="w-full text-white font-DMSans  bg-mainGreen flex flex-col gap-2 px-4 py-3 rounded-lg border-2 border-gray-[#E5E7EB]">
                        <div>
                            <p class="text-[1.5rem]">To-Do List</p>
                        </div>
                        <div class="flex flex-row gap-2">
                            @if(toDoListNumberLoading) {
                                Loading..
                            } @else {
                                <div class="flex flex-col justify-center items-center cursor-pointer hover:shadow-md hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./order-landing'])">
                                    <span class="text-[1.5rem]">{{toDoListNumber.unpaid_clients}}</span>
                                    <p class="text-center text-[0.6rem]">Unpaid Clients</p>
                                </div>
                                <div class="flex flex-col justify-center items-center cursor-pointer hover:shadow-md hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./supplier-transactions'])">
                                    <span class="text-[1.5rem]" >{{toDoListNumber.unpaid_transaction}}</span>
                                    <p class="text-center text-[0.6rem]">Unpaid Transactions</p>
                                </div>
                                <div class="flex flex-col justify-center items-center cursor-pointer hover:shadow-md hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./order-landing/manage-order-drafts'])">
                                    <span class="text-[1.5rem]">{{toDoListNumber.to_deliver}}</span>
                                    <p class="text-center text-[0.6rem]">Orders To Deliver</p>
                                </div>
                            }
                
                        </div>
                    </div>

                </div>

            </div>

            <div class="flex flex-row w-full h-[400px]">
                <div class="bg-white tablet:hover:shadow-md flex flex-co rounded-lg shadow-md border p-3 w-full">
    
    
                    <div class="flex flex-row  w-full">
                        <div class="bg-white flex flex-col rounded-lg w-full p-2">
                            <div class="flex p-3 n flex-col w-full h-full ">
                                <!-- TODO: Dynamic filter -->
                                <div class="flex justify-between">
                                    <h1 class="font-DMSans  font-medium mobileL:text-[1.5rem] text-[1.5rem]">{{this.monthNow()}} - Top 5 {{bestPerformanceFilter() === 'quantity' ? 'Most Sold' : 'Best Selling'}} Products</h1>
                                    <!-- <h1 class="font-DMSans text-formText font-medium mobileL:text-[2rem] text-[1.3rem]">Product Performance</h1> -->
                                    <button mat-button [matMenuTriggerFor]="menu">Rank by</button>
                                    <mat-menu #menu="matMenu">
                                    <button mat-menu-item (click)="bestPerformanceFilter.set('quantity')">By Quantity</button>
                                    <button mat-menu-item (click)="bestPerformanceFilter.set('revenue')">By Revenue</button>
                                    </mat-menu>
                                </div>

                                
                                
                                <div class="w-full h-full flex flex-row tablet:pb-3">
                                    <!-- <div class="tablet:flex hidden flex-col w-[30%]">
                                        1. Yo mama
                                        2. My momma
 
                                    </div> -->
                                    <div class="flex tablet:flex-col flex-row tablet:w-[100%] tablet:h-full w-full ">
                                        <canvas id="salesChart" height="200"></canvas>
                                    </div>
                                    
                                </div>

                            </div>
                            
                        </div>
        
                    </div>
                                
        
                </div>
            </div>
            <div class=" tablet:flex tablet:hover:shadow-md bg-white flex w-full flex-col rounded-lg shadow-md border p-2 h-[400px] overflow-hidden">
                <div class="bg-white flex w-full flex-col rounded-lg p-2 overflow-y-auto ">
                    <div class="flex p-2 n flex-row justify-between w-full">                                
                        <h1 class="font-DMSans text-formText font-medium text-[1.5rem] ">Product Purchase History</h1>
                        <button mat-button [matMenuTriggerFor]="historyMenu">Filter by</button>

                        <mat-menu #historyMenu="matMenu">
                        <button mat-menu-item (click)="analyticsService.queryProductHistory('recent')">Recently</button>
                        <button mat-menu-item (click)="analyticsService.queryProductHistory('one_month')">A Month Ago</button>
                        <button mat-menu-item (click)="analyticsService.queryProductHistory('three_month')">3 Months Ago</button>
                        <button mat-menu-item (click)="analyticsService.queryProductHistory('past_year')">A Year Ago</button>
                        <button mat-menu-item (click)="analyticsService.queryProductHistory('no_transaction')">No record</button>
                        </mat-menu>
                    </div>
                    <div class="px-2 overflow-y-auto no-scrollbar">

                        @if(!productHistoryLoading) {

                    <table class="w-full overflow-y-auto">
                        <tr class="px3">
                            <th class="text-start">Product Name</th>
                            <th class="text-start">Stock</th>
                            <th class="text-start">Last Purchase</th>
                        </tr>
                        @for (item of productHistory; track $index) {
                        <tr class="odd:bg-[#F8F8F8] px-3 py-2 text-[0.8rem]">
                            @if(item.has_variant) {
                                <td class="flex gap-2">
                                    @if(item.image_url) {
                                        <!-- <span class="w-full aspect-square size-10 tablet:size-14 flex items-center justify-center rounded">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                            </svg>
                                        </span> -->
                                        <img 
                                        class="aspect-square size-10 tablet:size-14 flex items-center justify-center rounded"
                                        [src]="mainPort + item.image_url" [alt]="item.variant_name">
                                    } @else {
                                        <span class="size-10 tablet:size-14 aspect-square flex items-center justify-center rounded">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                            </svg>
                                        </span>
                                    }
                                <div class="flex flex-col justify-center">
                                    <span class="">{{item.product_name}}</span>
                                    <p class="">{{item.variant_name}}</p>
                                </div>
                                </td>
                            } @else {
                                <td class="flex gap-2">
                                    @if(item.image_url) {
                                        <!-- <span class="w-full size-10 tablet:size-14 aspect-square flex items-center justify-center rounded">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                            </svg>
                                        </span> -->
                                        <img 
                                        class="size-10 tablet:size-14 aspect-square flex items-center justify-center rounded"
                                        [src]="mainPort + item.image_url" alt="">
                                    } @else {
                                        <span class="size-10 tablet:size-14 aspect-square flex items-center justify-center rounded">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                            </svg>
                                        </span>

                                        <!-- <img class="h-full w-full rounded-[5px] size-10 tablet:size-14 overflow-hidden  object-center" 
                                        loading="lazy" 
                                        [src]="'/icons/default_product_icon.svg'" 
                                        (error)="'/icons/default_product_icon.svg'"
                                        alt="{{ item.product_name }}"
                                        > -->
                                    }
                                    <div class="flex flex-col justify-center">
                                        <p class="">{{item.product_name}}</p>
                                    </div>
                                </td>
                            }
                            <td>{{item.stock_number}}</td>
                            <td>
                                @if(item.recent_transaction_date) {
                                    {{analyticsService.timeSince(item.recent_transaction_date)}}
                                } @else {
                                    <p>No Transaction Record!</p>
                                }
                            </td>
                        </tr>
                    } @empty {
                        <tr>
                            <td
                              colspan="3"
                              class="text-center text-mainGreen font-DMSans font-bold text-[1.7rem] tablet:text-[2rem] py-2"
                            >
                              No Records Found!
                            </td>
                          </tr>
}
                    </table>
                        } @else {
                            <div class="w-full flex justify-center items-center">
                                <mat-spinner class="mat-progress-spinner" [diameter]="50"></mat-spinner>
                            </div>
                } 

                    </div>
        
                                
        
                </div>
    
            </div>
    

        </div>

        
        <div class=" flex flex-col tablet:w-[40%] gap-2 w-full h-full ">

            <div class="tablet:flex hidden flex-row tablet:h-[200px] w-full border tablet:hover:shadow-md  shadow-md rounded-lg ">
                <div class="flex flex-row w-full" >

                    <div class="w-full text-white font-DMSans  bg-mainGreen flex flex-col gap-2 px-4 py-3 rounded-lg border-2 border-gray-[#E5E7EB]">
                        <div>
                            <p class="text-[1.5rem]">To-Do List</p>
                            <p class="text-[0.8rem]">
                                Things you need to deal with
                            </p>
                        </div>
                        <div class="flex gap-3">
                            @if(toDoListNumberLoading) {
                                Loading..
                            } @else {
                                <div class="flex-1 flex flex-col justify-center items-center cursor-pointer hover:text-[#EB8F71CC] hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./order-landing'])">
                                    <span class="tablet:text-[2.3rem]">{{toDoListNumber.unpaid_clients}}</span>
                                    <p>Unpaid Clients</p>
                                </div>
                                <div class="flex-1 flex flex-col justify-center items-center cursor-pointer hover:text-[#EB8F71CC] hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./supplier-transactions'])">
                                    <span class="tablet:text-[2.3rem]" >{{toDoListNumber.unpaid_transaction}}</span>
                                    <p>Unpaid Transactions</p>
                                </div>
                                <div class="flex-1 flex flex-col justify-center items-center cursor-pointer hover:text-[#EB8F71CC] hover:rounded-md px-2 py-1 transition-all" (click)="router.navigate(['./order-landing/manage-order-drafts'])">
                                    <span class="tablet:text-[2.3rem]">{{toDoListNumber.to_deliver}}</span>
                                    <p>Orders To Deliver</p>
                                </div>
                            }
                
                        </div>
                    </div>
    
                </div>

            </div>

            <div class="flex flex-row w-full tablet:h-[50%] ">

            
                <div class="bg-white tablet:hover:shadow-md tablet:h-[600px] flex flex-col rounded-lg shadow-md border  w-full p-2">
                    <div class="p-3 tablet:h-[400px] flex flex-row ">
                        <div class="grid grid-cols-[auto_auto] gap-3 w-full">
                            <div class="col-span-full flex gap-3 items-center">
                                <h1 class="font-DMSans text-formText font-medium tablet:text-[1.5rem] text-[1rem]"><span class="capitalize">{{stockFilterTerm ? stockFilterTerm : 'low stock'}}</span> Items</h1>
                                <button mat-button [matMenuTriggerFor]="stockFilter">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class=" size-6 aspect-square m-0">
                                        <path class="m-0" stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z" />
                                    </svg>
                                </button>
                                <mat-menu #stockFilter="matMenu" >
                                    <div class="font-DMSans">
                                        <button mat-menu-item (click)="stockFilterTerm = 'low stock'">Low Stock</button>
                                        <button mat-menu-item (click)="stockFilterTerm = 'critical stock'">Critical Stock</button>
                                        <button mat-menu-item (click)="stockFilterTerm = 'no stock'">No Stock</button>
                                        <button mat-menu-item (click)="stockFilterTerm = ''">Clear Filter</button>
                                    </div>
                                </mat-menu>
                            </div>
                            <hr>
                            @if(lowStockLoading) {
                                Loading...
                            } @else {
                                <div class="grid col-span-full grid-cols-subgrid h-[480px] overflow-y-auto no-scrollbar w-full">
                                    @for(item of productLowStock; track $index) {
                                        @if(stockFilterTerm === '' || item.stock_status.toLowerCase() === stockFilterTerm) {
                                            @if(item.has_variant) {
                                                <div class="grid col-span-full grid-cols-subgrid justify-between p-2 gap-3 items-center" 
                                                [ngClass]="(($index % 2 === 0) || ($index == 0)) ? 'bg-[#f8f8f8]' : 'bg-white'">
                                                    <div class="flex items-center gap-3">
                                                        <div class="hidden tablet:block size-10 tablet:size-14 overflow-hidden border-2 rounded">
                                                            @if(item.variant_image) {
                                                                <img class="flex-1 w-full aspect-square rounded border-gray-400" [src]="port+item.variant_image" 
                                                                [alt]="item.variant_name"
                                                                onerror="this.onerror=null; this.src=port+mainImageURL">
                                                            } @else {
                                                                <span class="w-full aspect-square flex items-center justify-center rounded">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                                                    </svg>
                                                                </span>
                                                            }
                                                        </div>
                                                        <div class="flex-1">
                                                            <p class="text-[0.75rem]">{{item.product_name}}</p>
                                                            <p class="text-[0.9rem]">{{item.variant_name}}</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex flex-col justify-center">
                                                        <p class="text-[0.75rem]">Stock: {{item.variant_stock}}</p>
                                                        <p class="font-semibold text-[0.7rem] tablet:text-[1rem]">{{item.stock_status}}</p>
                                                    </div>
                                                </div>
                                            } @else {
                                                <div class="grid col-span-full grid-cols-subgrid justify-between p-2 gap-3 items-center"
                                                [ngClass]="(($index % 2 === 0) || ($index == 0)) ? 'bg-[#f8f8f8]' : 'bg-white'">
                                                    <div class="flex items-center gap-3">
                                                        <div class="hidden tablet:block size-10 tablet:size-14 overflow-hidden border-2 rounded">
                                                            @if(item.product_stock) {
                                                                <img class="flex-1 w-full aspect-square rounded border-gray-400" [src]="port+item.product_stock" [alt]="item.product_name">
                                                            } @else {
                                                                <span class="w-full aspect-square flex items-center justify-center rounded">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                                                    </svg>
                                                                </span>
                                                            }
                                                        </div>
                                                        <div class="flex-1">
                                                            <p class="text-[0.9rem]">{{item.product_name}}</p>
                                                        </div>
                                                    </div>
                                                    <div class="flex flex-col justify-center">
                                                        <p class="text-[0.75rem]">Stock: {{item.product_stock}}</p>
                                                        <p class="font-semibold text-[0.7rem] tablet:text-[1rem]">{{item.stock_status}}</p>
                                                    </div>
                                                </div>
                                            }
                                        }
                                    }
                                </div>
                            }
                        </div>
                        
                    </div>
                </div>
            </div>
            
    

        </div>

    </div>    
    

    


        
</div>
} @else {
    <div class="flex flex-col justify-center items-center h-full">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class=" size-12 text-mainGreen">
            <path stroke-linecap="round" stroke-linejoin="round" d="m3 3 8.735 8.735m0 0a.374.374 0 1 1 .53.53m-.53-.53.53.53m0 0L21 21M14.652 9.348a3.75 3.75 0 0 1 0 5.304m2.121-7.425a6.75 6.75 0 0 1 0 9.546m2.121-11.667c3.808 3.807 3.808 9.98 0 13.788m-9.546-4.242a3.733 3.733 0 0 1-1.06-2.122m-1.061 4.243a6.75 6.75 0 0 1-1.625-6.929m-.496 9.05c-3.068-3.067-3.664-7.67-1.79-11.334M12 12h.008v.008H12V12Z" />
        </svg>
        <p
        class="text-center text-mainGreen font-DMSans font-bold text-[1.7rem] tablet:text-[2rem] py-2"
        >
            You are offline!
        </p>
    </div>
}